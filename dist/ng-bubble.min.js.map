{"version":3,"sources":["ng-bubble.js"],"names":["angular","module","directive","$interact","interact","restrict","link","$scope","element","attrs","dragOptions","$eval","draggable","resizeOptions","resizable","scope","transclude","replace","template","factory","$compile","$rootScope","$templateCache","$http","$q","$animate","bbRootScope","$new","bbScopes","__create","_options","bubble","__mergeOptions","parent","css","data","__getTemplate","then","_tmpl","__setBubbleStyle","remove","__getRemoveHandler","push","enter","__dragMoveListener","event","target","x","parseFloat","getAttribute","dx","y","dy","style","webkitTransform","transform","setAttribute","__removeAllBubbles","i","length","__resizeMoveListner","width","rect","height","deltaRect","left","top","__getDefaultOptions","templateUrl","document","querySelector","inertia","restriction","endOnly","elementRect","bottom","right","autoScroll","onmove","preserveAspectRatio","edges","invert","_bubble","_scope","splice","indexOf","leave","promise","getTemplateJob","defer","trim","get","cache","_response","resolve","key","DEFAULT_OPTIONS","keys","Object","attr","create","removeAllBubbles"],"mappings":"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","file":"ng-bubble.min.js","sourcesContent":["angular.module(\"itman.interact\", []).directive('ngInteract', function() {\n    'use strict';\n\n\tvar $interact = interact;\n\n    return {\n    \trestrict: 'A',\n    \tlink: function($scope, element, attrs) {\n    \t\tvar dragOptions = $scope.$eval(attrs.draggable);\n    \t\tvar resizeOptions = $scope.$eval(attrs.resizable);\n\n    \t\t$interact(element[0])\n    \t\t\t.draggable(dragOptions)\n    \t\t\t.resizable(resizeOptions);\n    \t}\n    };\n});\n\n\nangular.module(\"itman.bubble\", ['itman.interact']);\nangular.module(\"itman.bubble\").directive('ngBubble', function() {\n    'use strict';\n\n    return {\n    \trestrict: 'E',\n    \tscope: {\n    \t\tdragOptions: '=',\n    \t\tresizeOptions: '='\n    \t},\n    \ttransclude: true,\n    \treplace: true,\n    \ttemplate: '<div class=\"ng-bubble\" ng-interact draggable=\"dragOptions\" resizable=\"resizeOptions\" ng-transclude></div>',\n\n    \t// link: function($scope, element, attrs) {\n    \t// \tconsole.log(attrs);\n    \t// }\n    };\n});\n\nangular.module(\"itman.bubble\").factory('BubbleService', function($compile, $rootScope, $templateCache, $http, $q, $animate) {\n\t'use strict';\n\n\tvar bbRootScope = $rootScope.$new();\n\tvar bbScopes = [];\n\n\tvar __create = function(_options){\n\t\tvar scope, bubble;\n\t\t_options = __mergeOptions(_options);\n\t\t_options.parent.css(\"position\", \"relative\");\n\n\t\tscope = bbRootScope.$new(true);\n\t\tscope.data = _options.data;\n\t\tscope.dragOptions = _options.dragOptions;\n\t\tscope.resizeOptions = _options.resizeOptions;\n\n\t\treturn __getTemplate(_options).then(function(_tmpl){\n\t\t\tbubble = $compile(_tmpl)(scope);\n\n\t\t\t__setBubbleStyle(bubble, _options);\n\t\t\tscope.remove = __getRemoveHandler(bubble, scope);\n\t\t\tbbScopes.push(scope);\n\n\t\t\treturn $animate.enter(bubble, _options.parent);\n\t\t});\n\t};\n\n\tvar __dragMoveListener = function(event) {\n\t    var target = event.target,\n\t        // keep the dragged position in the data-x/data-y attributes\n\t        x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,\n\t        y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;\n\n\t    // translate the element\n\t    target.style.webkitTransform =\n\t    target.style.transform =\n\t      'translate(' + x + 'px, ' + y + 'px)';\n\n\t    // update the posiion attributes\n\t    target.setAttribute('data-x', x);\n\t    target.setAttribute('data-y', y);\n\t};\n\n\tvar __removeAllBubbles = function(){\n\t\tvar i;\n\t\tfor(i=0; i < bbScopes.length; i++){\n\t\t\tbbScopes[i].remove();\n\t\t\ti--;\n\t\t}\n\t};\n\n\tvar __resizeMoveListner = function (event) {\n    \tvar target = event.target,\n\t        x = (parseFloat(target.getAttribute('data-x')) || 0),\n\t        y = (parseFloat(target.getAttribute('data-y')) || 0);\n\n\t    // update the element's style\n\t    target.style.width  = event.rect.width + 'px';\n\t    target.style.height = event.rect.height + 'px';\n\n\t    // translate when resizing from top or left edges\n\t    x += event.deltaRect.left;\n\t    y += event.deltaRect.top;\n\n    \ttarget.style.webkitTransform =\n    \ttarget.style.transform =\n        \t'translate(' + x + 'px,' + y + 'px)';\n\n\t    target.setAttribute('data-x', x);\n\t    target.setAttribute('data-y', y);\n  \t};\n\n\tvar __getDefaultOptions = function(){\n\t\treturn {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\ttemplateUrl: '',\n\t\t\ttemplate: '<div></div>',\n\t\t\tparent: angular.element(document.querySelector('body')),\n\t\t\tdata: {},\n\t\t\tdragOptions: {\n\t\t\t    // enable inertial throwing\n\t\t\t    inertia: true,\n\t\t\t    // keep the element within the area of it's parent\n\t\t\t    restrict: {\n\t\t\t    \trestriction: \"parent\",\n\t\t\t    \tendOnly: true,\n\t\t\t    \telementRect: { top: 0, left: 0, bottom: 1, right: 1 }\n\t\t\t    },\n\t\t\t    // enable autoScroll\n\t\t\t    autoScroll: true,\n\n\t\t\t    // call this function on every dragmove event\n\t\t\t    onmove: __dragMoveListener\n\t\t\t},\n\t\t\tresizeOptions: {\n\t\t\t\tpreserveAspectRatio: false,\n    \t\t\tedges: { left: true, right: true, bottom: true, top: true },\n    \t\t\tinvert: \"none\",\n    \t\t\tonmove: __resizeMoveListner\n\t\t\t}\n\t\t};\n\t};\n\n\tvar __getRemoveHandler = function(_bubble, _scope){\n\t\treturn function(){\n\t\t\tbbScopes.splice(bbScopes.indexOf(_scope), 1);\n\t\t\t$animate.leave(_bubble);\n\t\t};\n\t};\n\n\tvar __getTemplate = function(_options){\n\t\tvar getTemplateJob = $q.defer();\n\t\tvar templateUrl = _options.templateUrl.trim();\n\t\tvar promise;\n\n\t\tif(templateUrl !== \"\"){\n\t\t\tpromise = $http.get(templateUrl, {cache: $templateCache}).then(function(_response){\n\t\t\t\treturn _response.data;\n\t\t\t});\n\t\t} else {\n\t\t\tpromise = getTemplateJob.promise;\n\t\t\tgetTemplateJob.resolve(_options.template);\n\n\t\t}\n\n\t\treturn promise.then(function(_tmpl){\n\t\t\treturn '<ng-bubble drag-options=\"dragOptions\" resize-options=\"resizeOptions\">'+\n\t\t\t\t\t\t_tmpl +\n\t\t\t\t\t'</ng-bubble>';\n\t\t});\n\t};\n\n\tvar __mergeOptions = function(_options){\n\t\tvar DEFAULT_OPTIONS = __getDefaultOptions();\n\t\tvar keys = Object.keys(DEFAULT_OPTIONS);\n\t\tvar i, key;\n\t\t_options = _options || {};\n\n\t\tfor(i=0; i < keys.length; i++){\n\t\t\tkey = keys[i];\n\t\t\t_options[key] = _options[key] || DEFAULT_OPTIONS[key];\n\t\t}\n\n\t\treturn _options;\n\t};\n\n\tvar __setBubbleStyle = function(_bubble, _options){\n\t\t// set init position\n\t\tvar style = 'translate(' + _options.x + 'px, ' + _options.y + 'px)';\n\t\t_bubble.css(\"transform\", style);\n\t\t_bubble.attr('data-x', _options.x);\n\t    _bubble.attr('data-y', _options.y);\n\n\t\t// set the style of the bubble\n\t\t_bubble.css(\"position\", \"absolute\");\n\t};\n\n\treturn {\n\t\tcreate: __create,\n\t\tremoveAllBubbles: __removeAllBubbles\n\t};\n});"],"sourceRoot":"/source/"}